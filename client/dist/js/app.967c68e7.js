(function(e){function t(t){for(var o,n,i=t[0],c=t[1],l=t[2],d=0,m=[];d<i.length;d++)n=i[d],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&m.push(s[n][0]),s[n]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(m.length)m.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],o=!0,i=1;i<a.length;i++){var c=a[i];0!==s[c]&&(o=!1)}o&&(r.splice(t--,1),e=n(n.s=a[0]))}return e}var o={},s={app:0},r=[];function n(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=o,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var o=a("85ec"),s=a.n(o);s.a},"15db":function(e,t,a){"use strict";var o=a("66c6"),s=a.n(o);s.a},"1b0a":function(e,t,a){"use strict";var o=a("d9fa"),s=a.n(o);s.a},3860:function(e,t,a){},"3fb1":function(e,t,a){e.exports=a.p+"img/book.0f6f6fe1.png"},4033:function(e,t,a){"use strict";var o=a("98ad"),s=a.n(o);s.a},"55f4":function(e,t,a){"use strict";var o=a("3860"),s=a.n(o);s.a},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("2b0e"),s=a("5f5b");a("ab8b"),a("2dd8");o["default"].use(s["a"]);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("NavBar",{attrs:{id:"top"}}),a("router-view")],1)},n=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("nav",{staticClass:"navbar navbar-light border-bottom mt-1"},[a("a",{staticClass:"navbar-brand",attrs:{href:"#/store"}},[e._v("BookStore")]),a("ul",{staticClass:"nav nav-fill nav-pills"},[a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",class:"/store"===e.$route.path?"active":"text-muted",attrs:{href:"#/store"}},[e._v("商城")])]),a("li",{staticClass:"nav-item"},[a("el-badge",{attrs:{value:e.totalCount}},[a("a",{staticClass:"nav-link",class:"/cart"===e.$route.path?"active":"text-muted",attrs:{href:"#/cart"}},[e._v("购物车")])])],1)]),e.ifLogin?a("a",{attrs:{href:"#/user-info"}},[e._v(" 已登录： "+e._s(e.userAccount)+" ")]):a("a",{attrs:{href:"#/login"}},[a("i",{staticClass:"iconfont icon-denglu",attrs:{herf:"#/login"}}),e._v(" 登录/注册 ")])])])},c=[],l={name:"NavBar",computed:{totalCount:function(){return this.$store.getters.totalOrderCount},ifLogin:function(){return console.log("ifLogin",this.$store.getters.ifLogin),this.$store.getters.ifLogin},userAccount:function(){return this.$store.getters.userAccount}}},u=l,d=a("2877"),m=Object(d["a"])(u,i,c,!1,null,"b3318548",null),p=m.exports,f={name:"app",components:{NavBar:p}},g=f,h=(a("034f"),Object(d["a"])(g,r,n,!1,null,null,null)),b=h.exports,v=a("8c4f"),k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"store"},[a("el-row",e._l(e.books.slice(12*(e.pageIndex-1),12*e.pageIndex),(function(e,t){return a("BookCard",{key:t,attrs:{id:e.id,name:e.name,author:e.publisher,desc:e.info,price:e.price,imgPath:e.imgPath}})})),1),a("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:e.books.length,"page-size":12,"hide-on-single-page":!0},on:{"current-change":e.changePage}})],1)},x=[],y=a("5530"),w=a("2f62"),_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("el-card",{staticClass:"box-card"},[a("img",{staticClass:"book-img",attrs:{src:e.imgData,alt:e.name}}),a("div",{staticClass:"book-title"},[e._v(e._s(e.name))]),a("div",{staticClass:"book-author"},[e._v("出版社："+e._s(e.author))]),a("hr"),a("div",{staticClass:"book-desc"},[e._v("简介："+e._s(e.desc))]),a("div",{staticClass:"cart"},[a("div",{staticClass:"book-price"},[e._v(e._s(e.price)+"￥")]),a("el-input-number",{staticStyle:{"margin-bottom":"5px"},attrs:{min:1,size:"mini"},model:{value:e.count,callback:function(t){e.count=t},expression:"count"}}),a("br"),a("el-button",{attrs:{type:"danger"},on:{click:e.handleAddOrder}},[e._v("添加购物车")])],1)])],1)},C=[],S=(a("b0c0"),a("a9e3"),{props:{id:Number,name:String,author:String,desc:String,price:Number,imgPath:String},data:function(){return{count:1,imgData:String}},mounted:function(){var e=this;this.axios.get("/server/file/get",{params:{fileName:this.imgPath}}).then((function(t){var a=t.data.imgData;e.imgData="data:image/jpg;base64,"+a})).catch((function(e){console.log(e)}))},methods:{handleAddOrder:function(){console.log("name"+this.name);var e={id:this.id,imgData:this.imgData,name:this.name,count:this.count,price:this.price};this.$store.commit("addOrder",e),this.$message({message:"添加成功！",type:"success",showClose:!0})}}}),$=S,F=(a("1b0a"),Object(d["a"])($,_,C,!1,null,"048f2c10",null)),P=F.exports,O={name:"Store",data:function(){return{pageIndex:1,books:[]}},components:{BookCard:P},computed:Object(y["a"])({},Object(w["b"])({})),methods:{changePage:function(e){this.pageIndex=e,scrollTo(0,0)}},mounted:function(){var e=this;this.axios.get("/server/book/all").then((function(t){console.log("all books",t),e.books=t.data})).catch((function(e){console.log(e)}))}},D=O,j=Object(d["a"])(D,k,x,!1,null,null,null),A=j.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{margin:"20px"}},[a("el-table",{attrs:{data:e.tableData,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"商品信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{attrs:{src:t.row.imgData,alt:"bookcover",width:"120px"}}),a("div",{staticClass:"book-name"},[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{attrs:{min:1,size:"mini"},model:{value:t.row.count,callback:function(a){e.$set(t.row,"count",a)},expression:"scope.row.count"}})]}}])}),a("el-table-column",{attrs:{label:"单价",prop:"price"}}),a("el-table-column",{attrs:{label:"总价"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(" "+e._s((t.row.count*t.row.price).toFixed(2))+" ")])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger"},on:{click:function(a){return e.showDialog(t.$index)}}},[e._v(" 删除 ")])]}}])})],1),a("el-dialog",{attrs:{visible:e.dialog1Visible,width:"30%"},on:{"update:visible":function(t){e.dialog1Visible=t}}},[a("span",[e._v("确定删除吗？")]),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog1Visible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteOrder(e.indexToDelete)}}},[e._v("确 定")])],1)]),a("div",{staticClass:"commit-orders"},[a("span",[e._v("总价："+e._s(e.totalPrice.toFixed(2)))]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning"},on:{click:function(t){e.dialog2Visible=!0}}},[e._v(" 清空购物车 ")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger"},on:{click:e.commit}},[e._v("提交订单 ")])],1),a("el-dialog",{attrs:{visible:e.dialog2Visible,width:"30%"},on:{"update:visible":function(t){e.dialog2Visible=t}}},[e._v(" 确定清空购物车吗？ "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog2Visible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"danger"},on:{click:e.clearCart}},[e._v("确 定")])],1)])],1)},B=[],L=(a("4160"),a("159b"),{name:"Cart",data:function(){return{dialog1Visible:!1,dialog2Visible:!1,indexToDelete:0}},computed:Object(y["a"])({},Object(w["b"])({tableData:function(e){return e.Orders.bookOrders}}),{totalPrice:function(){return this.$store.getters.totalPrice}}),methods:{commit:function(){var e=this;this.tableData.forEach((function(t){console.log("committing order, bookid: "+t.id+", count: "+t.count),e.axios.post("/server/order/addbook",{bookid:t.id,count:t.count}).then((function(a){e.$message({message:"提交成功！",type:"success",showClose:!0}),t["commited"]=!0,e.$store.commit("deleteCommitedOrders")})).catch((function(e){console.log(e)}))}))},showDialog:function(e){this.dialog1Visible=!0,this.indexToDelete=e},deleteOrder:function(e){console.log("delete order index: "+e),this.$store.commit("deleteOrder",e),this.dialog1Visible=!1},clearCart:function(){this.$store.commit("clearCart"),this.dialog2Visible=!1}}}),U=L,E=(a("bb0e"),Object(d["a"])(U,V,B,!1,null,"dfe9de80",null)),N=E.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"text-align":"start",margin:"10px"}},[e._v("商品列表：")]),a("div",{staticStyle:{margin:"20px"}},[a("el-table",{attrs:{data:e.tableData,stripe:"",size:"small"}},[a("el-table-column",{attrs:{label:"书名",prop:"name"}}),a("el-table-column",{attrs:{prop:"count",label:"数量"}}),a("el-table-column",{attrs:{label:"总价"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(" "+e._s(t.row.price*t.row.count)+" ")])]}}])})],1)],1),a("div",{staticStyle:{"margin-top":"10px"}},[e._v("总价："+e._s(e.totalPrice))]),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-row",{attrs:{align:"middle",type:"flex"}},[a("el-col",{attrs:{span:3,offset:5}},[e._v("收货地址：")]),a("el-col",{attrs:{span:10}},[a("el-input",{attrs:{placeholder:"请输入收货地址",type:"textarea",autosize:""},model:{value:e.diliverAddress,callback:function(t){e.diliverAddress=t},expression:"diliverAddress"}})],1)],1)],1),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(" 确认提交 ")])],1),a("el-dialog",{attrs:{visible:e.dialogVisible,width:"30%",title:"确认提交订单？"},on:{"update:visible":function(t){e.dialogVisible=t}}},[e._v(" 总价："+e._s(e.totalPrice)),a("br"),e._v(" 收货地址："+e._s(e.diliverAddress)+" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)])],1)},z=[],T={name:"CommitOrders",data:function(){return{diliverAddress:"",dialogVisible:!1}},computed:Object(y["a"])({},Object(w["b"])({tableData:function(e){return e.Orders.bookOrders}}),{totalPrice:function(){return this.$store.getters.totalPrice}})},I=T,W=(a("d10f"),Object(d["a"])(I,q,z,!1,null,"35f9536a",null)),M=W.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-info"},[a("el-tabs",{attrs:{"tab-position":"left"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"个人详细信息",name:"first"}},[a("el-form",{attrs:{model:e.form,"label-position":"top"}},[a("el-form-item",{attrs:{label:"用户姓名:"}},[a("el-col",{attrs:{span:6}},[a("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"11",autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),a("el-form-item",{attrs:{label:"备注:"}},[a("el-col",{attrs:{span:6}},[a("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"11",autocomplete:"off"},model:{value:e.form.info,callback:function(t){e.$set(e.form,"info",t)},expression:"form.info"}})],1)],1),a("el-form-item",{attrs:{label:"收货地址："}},[a("div",[a("v-distpicker",{attrs:{"hide-area":"",province:e.form.province,city:e.form.city},on:{province:e.onChangeProvince,city:e.onChangeCity}})],1),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-input",{attrs:{placeholder:"详细地址",type:"textarea"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1)]),a("el-button",{attrs:{type:"success",icon:"el-icon-edit"},on:{click:e.changeUserInfo}},[e._v("确认修改")]),a("el-button",{staticClass:"updateCode-item",attrs:{type:"danger",icon:"el-icon-edit"},on:{click:e.quit}},[e._v("退出登录")])],1)],1),a("el-tab-pane",{attrs:{label:"修改密码",name:"second"}},[a("el-form",{ref:"dataForm",attrs:{model:e.code,rules:e.rules,"label-position":"top"}},[a("el-form-item",{staticClass:"dialogShow",attrs:{label:"新密码:",prop:"userPassword"}},[a("el-col",{attrs:{span:6}},[a("el-input",{staticStyle:{width:"200px"},attrs:{type:"password",placeholder:"请输入新密码",autocomplete:"off"},model:{value:e.code.userPassword,callback:function(t){e.$set(e.code,"userPassword",t)},expression:"code.userPassword"}})],1)],1),a("el-form-item",{staticClass:"dialogShow",attrs:{label:"确认密码:",prop:"aginUserPassword"}},[a("el-col",{attrs:{span:6}},[a("el-input",{staticStyle:{width:"200px"},attrs:{type:"password",placeholder:"请输入确认新密码",autocomplete:"off"},model:{value:e.code.aginUserPassword,callback:function(t){e.$set(e.code,"aginUserPassword",t)},expression:"code.aginUserPassword"}})],1)],1)],1),a("el-button",{staticClass:"updateCode-item",attrs:{type:"success",icon:"el-icon-edit"},on:{click:e.changeUserPwd}},[e._v("确 定")])],1)],1)],1)},J=[],G=a("273c"),H=a.n(G),Q={data:function(){var e=this,t=function(t,a,o){""===a?o(new Error("确认密码不能为空")):a!==e.code.userPassword?o(new Error("两次输入的密码不一致！")):o()};return{activeName:"first",form:{},code:{},imgUrl:"",qiniuData:{token:"",key:""},rules:{userPassword:[{required:!0,message:"密码不能为空",trigger:"blur"}],aginUserPassword:[{required:!0,validator:t,trigger:"blur"}]}}},components:{VDistpicker:H.a},created:function(){this.form.userPassword="",this.imgUrl=this.form.userHeadImg},methods:{changeUserInfo:function(){var e=this;this.axios.post("/server/user/update",this.form).then((function(t){e.$message({message:"修改成功！",type:"success",showClose:!0})})).catch((function(e){console.log(e)}))},changeUserPwd:function(){var e=this;this.$refs["dataForm"].validate((function(t){t?e.axios.post("/server/user/update",{password:e.code.userPassword}).then((function(t){e.$message({message:"修改成功！",type:"success",showClose:!0})})).catch((function(e){console.log(e)})):console.log("error submit!!")}))},onChangeProvince:function(e){"Province"!==e.value?this.form.province=e.value:delete this.form.province},onChangeCity:function(e){"City"!==e.value?this.form.city=e.value:delete this.form.city},quit:function(){var e=this;this.axios.get("/server/user/logout").then((function(e){console.log("logout response",e)})).catch((function(e){console.log(e)})).then((function(t){console.log("logout response",t),e.$store.commit("quit"),e.$router.push({path:"/store"})})).catch((function(e){console.log(e)}))}},mounted:function(){var e=this,t=this.$cookies.get("jsessionid");console.log("getcookie",t),this.axios.get("/server/user/info",{},{headers:{"X-CSRFToken":this.$cookies.get("jsessionid"),"Content-type":"application/json",Cookie:"jsessionid="+this.$cookies.get("jsessionid")}}).then((function(t){e.form=t.data}))}},X=Q,K=(a("879d"),Object(d["a"])(X,R,J,!1,null,null,null)),Y=K.exports,Z=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-row",{staticClass:"loginRow"},[o("img",{attrs:{id:"imgLogin",src:a("3fb1")}}),o("transition",{attrs:{mode:"out-in"}},[o(e.comName,{tag:"component",staticClass:"card",attrs:{componentName:e.comName},on:{listen:e.changeCard}})],1)],1)},ee=[],te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"loginCard"},[a("p",{staticStyle:{"text-align":"center"},attrs:{id:"UserLogin"}},[e._v("用户登录")]),a("el-form",{ref:"loginForm",staticStyle:{position:"relative",top:"20px"},attrs:{model:e.loginForm,"label-width":"40px",rules:e.rules}},[a("el-form-item",{attrs:{label:"账号",prop:"account"}},[a("el-input",{staticClass:"inputBox",attrs:{placeholder:"请输入账号"},model:{value:e.loginForm.account,callback:function(t){e.$set(e.loginForm,"account",t)},expression:"loginForm.account"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"pass"}},[a("el-input",{staticClass:"inputBox pwdBox",attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.loginForm.pass,callback:function(t){e.$set(e.loginForm,"pass",t)},expression:"loginForm.pass"}})],1),a("el-button",{staticClass:"loginButton cardButton",attrs:{type:"warning"},on:{click:e.login}},[e._v("登录")]),a("p"),a("el-button",{staticClass:"signupButton cardButton",attrs:{type:"danger"},on:{click:e.toSetUp}},[e._v("注册")])],1)],1)},ae=[],oe={props:{componentName:{type:String,default:function(){return""}}},data:function(){var e=this,t=function(t,a,o){if(!a)return o(new Error("账号不能为空"));""!==e.loginForm.account&&e.$refs.loginForm.validateField("checkPass"),o()},a=function(t,a,o){""===a?o(new Error("请输入密码")):(""!==e.loginForm.checkPass&&e.$refs.loginForm.validateField("checkPass"),o())};return{loginForm:{pass:"",account:""},rules:{account:[{validator:t,trigger:"blur"}],pass:[{validator:a,trigger:"blur"}]}}},methods:{toSetUp:function(){this.$emit("listen","setUpCard")},login:function(){var e=this,t=this;this.$refs.loginForm.validate((function(a){a?e.axios.post("/server/user/login",{account:t.loginForm.account,password:t.loginForm.pass}).then((function(e){console.log("login response",e),200===e.status?(t.$store.commit("successLogin",t.loginForm.account),t.$router.push({path:"/store"})):t.message.error("账号或密码错误！")})).catch((function(e){t.$message({message:"账号或密码错误！",type:"error",showClose:!0})})):console.log("error submit!!")}))},toGetBackPassword:function(){this.$emit("listen","getBackPassword")}}},se=oe,re=(a("55f4"),Object(d["a"])(se,te,ae,!1,null,null,null)),ne=re.exports,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"loginCard"},[a("p",{attrs:{id:"#UserSignUp"}},[e._v("用户注册")]),a("el-form",{ref:"SignupForm",staticStyle:{position:"relative",top:"20px"},attrs:{model:e.SignupForm,"label-width":"70px","label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:"账号",prop:"account"}},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.SignupForm.account,callback:function(t){e.$set(e.SignupForm,"account",t)},expression:"SignupForm.account"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"pass"}},[a("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.SignupForm.pass,callback:function(t){e.$set(e.SignupForm,"pass",t)},expression:"SignupForm.pass"}})],1),a("el-form-item",{attrs:{label:"确认密码",prop:"pass2"}},[a("el-input",{attrs:{type:"password",placeholder:"确认密码"},model:{value:e.SignupForm.pass2,callback:function(t){e.$set(e.SignupForm,"pass2",t)},expression:"SignupForm.pass2"}})],1),a("el-button",{staticClass:"loginButton cardButton",attrs:{type:"danger"},on:{click:e.register}},[e._v("注册")]),a("p"),a("el-button",{staticClass:"cardButton",attrs:{id:"ReturnButton",type:"warning",long:""},on:{click:e.toLogin}},[e._v("返回登录")])],1)],1)},ce=[],le={data:function(){var e=this,t=function(t,a,o){if(!a)return o(new Error("账号不能为空"));""!==e.SignupForm.account&&e.$refs.SignupForm.validateField("checkPass"),o()},a=function(t,a,o){""===a?o(new Error("请输入密码")):(""!==e.SignupForm.checkPass&&e.$refs.SignupForm.validateField("checkPass"),o())},o=function(t,a,o){""===a?o(new Error("请再次密码")):a!==e.SignupForm.pass?o(new Error("两次输入的密码不一致")):(""!==e.SignupForm.checkPass&&e.$refs.SignupForm.validateField("checkPass"),o())};return{SignupForm:{pass:"",pass2:"",account:""},rules:{account:[{validator:t,trigger:"blur"}],pass:[{validator:a,trigger:"blur"}],pass2:[{validator:o,trigger:"blur"}]}}},methods:{toLogin:function(){this.$emit("listen","loginCard")},register:function(){var e=this,t=this;console.log("try register"),this.$refs.SignupForm.validate((function(a){a?(console.log(t.SignupForm.account,t.SignupForm.pass),e.axios.post("/server/user/register",{account:t.SignupForm.account,password:t.SignupForm.pass}).then((function(e){console.log("login response",e),200===e.status?(t.$store.commit("successLogin",t.SignupForm.account),t.$router.push({path:"/store"})):alert("注册失败，账号已被占用")})).catch((function(e){console.log(e)}))):console.log("error submit!!")}))}}},ue=le,de=(a("ff34"),Object(d["a"])(ue,ie,ce,!1,null,null,null)),me=de.exports,pe={name:"Login",components:{loginCard:ne,setUpCard:me},data:function(){return{comName:"loginCard"}},methods:{changeCard:function(e){this.comName=e}}},fe=pe,ge=(a("4033"),Object(d["a"])(fe,Z,ee,!1,null,"2fa8980b",null)),he=ge.exports,be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"manager-view"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"书籍管理",name:"books"}},[a("book-manage")],1),a("el-tab-pane",{attrs:{label:"订单管理",name:"orders"}},[a("order-manage")],1)],1)],1)},ve=[],ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticStyle:{float:"right",margin:"20px 20px"},attrs:{type:"primary"},on:{click:e.addBook}},[e._v("添加书籍")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"80"}}),a("el-table-column",{attrs:{label:"书籍封面"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.imgData,"min-width":"50",height:"50"}})]}}])}),a("el-table-column",{attrs:{prop:"name",label:"书籍名称"}}),a("el-table-column",{attrs:{prop:"publisher",label:"出版社"}}),a("el-table-column",{attrs:{prop:"storeCount",label:"库存数量"}}),a("el-table-column",{attrs:{prop:"price",label:"单价"}}),a("el-table-column",{attrs:{prop:"info",label:"书籍描述"}}),a("el-table-column",{attrs:{align:"center",prop:"created_at",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.editBook(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteBook(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticStyle:{float:"right","margin-top":"30px"}},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){e.isAdd=!1}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form}},[a("el-form-item",{attrs:{"label-width":e.imgLabelWidth,label:"书籍封面",prop:"imgData"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://jsonplaceholder.typicode.com/posts/",drag:"","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?a("img",{attrs:{id:"dialog-img",src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{staticClass:"dialogShow",attrs:{label:"书籍名称:","label-width":e.formLabelWidth}},[a("el-input",{staticClass:"input_length",attrs:{placeholder:"请输入书籍名称",autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{staticClass:"dialogShow",attrs:{label:"出版社:","label-width":e.formLabelWidth}},[a("el-input",{staticClass:"input_length",attrs:{placeholder:"请输入图书出版单位",autocomplete:"off"},model:{value:e.form.publisher,callback:function(t){e.$set(e.form,"publisher",t)},expression:"form.publisher"}})],1),a("el-form-item",{staticClass:"dialogShow",attrs:{label:"描述:","label-width":e.formLabelWidth}},[a("el-input",{staticClass:"input_length",attrs:{placeholder:"请输入图书描述",autocomplete:"off"},model:{value:e.form.info,callback:function(t){e.$set(e.form,"info",t)},expression:"form.info"}})],1),a("el-form-item",{staticClass:"dialogShow",attrs:{label:"库存数量:","label-width":e.formLabelWidth}},[a("el-input",{staticClass:"input_length",attrs:{placeholder:"请输入库存数量",autocomplete:"off"},model:{value:e.form.storeCount,callback:function(t){e.$set(e.form,"storeCount",t)},expression:"form.storeCount"}})],1),a("el-form-item",{staticClass:"dialogShow",attrs:{label:"单价:","label-width":e.formLabelWidth}},[a("el-input",{staticClass:"input_length",attrs:{placeholder:"请输入单价",autocomplete:"off"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelChange}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.uploadImg}},[e._v("上传图片")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitChange}},[e._v("确 定")])],1)],1)],1)},xe=[],ye=(a("ac1f"),a("5319"),a("1276"),{name:"book-manage",data:function(){return{tableData:[],total:0,currentPage:1,filterQuery:{pageNum:1,pageSize:10},form:{},imageUrl:"",imageName:"",dialogFormVisible:!1,textMap:{create:"添加书籍",update:"修改书籍"},formLabelWidth:"120px",imgLabelWidth:"120px",isAdd:!1}},computed:{dialogStatus:function(){return this.isAdd?"create":"update"}},mounted:function(){var e=this;this.axios.get("/server/book/all").then((function(t){e.tableData=t.data;e.tableData;e.total=e.tableData.length;for(var a=function(t){var a=e.tableData[t];e.axios.get("/server/file/get",{params:{fileName:a.imgPath}}).then((function(o){console.log("load",a.imgPath),e.tableData[t].imgData="data:image/jpg;base64,"+o.data.imgData}))},o=0;o<e.tableData.length;o++)a(o)})).catch((function(e){console.log(e)}))},methods:{refresh:function(){var e=this;this.axios.get("/server/book/all").then((function(t){e.tableData=t.data;e.tableData;e.total=e.tableData.length;for(var a=function(t){var a=e.tableData[t];e.axios.get("/server/file/get",{params:{fileName:a.imgPath}}).then((function(o){console.log("load",a.imgPath),e.tableData[t].imgData="data:image/jpg;base64,"+o.data.imgData}))},o=0;o<e.tableData.length;o++)a(o)})).catch((function(e){console.log(e)}))},handleCurrentChange:function(){},handleAvatarSuccess:function(e,t){},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<2;if(t||this.$message.error("上传封面图片只能是 JPG/png 格式!"),a||this.$message.error("上传封面图片大小不能超过 2MB!"),t&&a){var o=new FileReader;o.readAsDataURL(e);var s=this;this.imageName=e.name,o.onload=function(e){s.imageUrl=this.result}}return!0},uploadImg:function(){var e=this,t=this.imageUrl.split(",")[1];this.axios.post("/server/file/upload",{fileName:this.imageName,imgData:t}).then((function(t){e.form.imgPath=t.data.replace(/[\r\n]/g,""),e.$message.success("图片上传成功")})).catch((function(t){console.log(t),e.$message.error("图片上传失败")}))},cancelChange:function(){this.dialogFormVisible=!1,this.form={}},submitChange:function(){var e=this;console.log(this.form),this.isAdd?this.axios.post("/server/book/add",this.form).then((function(t){e.$message.success("修改成功"),e.dialogFormVisible=!1,e.isAdd=!1,e.refresh()})).catch((function(t){console.log(t),e.$message.error("修改失败")})):(console.log("updata",this.form),this.axios.post("/server/book/updata",this.form).then((function(t){e.$message.success("修改成功"),e.dialogFormVisible=!1,e.refresh()})).catch((function(t){console.log(t),e.$message.error("修改失败")})))},editBook:function(e,t){console.log("edit",t),this.dialogFormVisible=!0,this.form=t,this.imageUrl=this.form.imgData},deleteBook:function(e,t){var a=this;console.log(t),this.axios.post("/server/book/delete",{id:t.id}).then((function(e){a.$message.success("删除成功"),a.dialogFormVisible=!1,a.refresh()})).catch((function(e){console.log(e),a.$message.error("删除失败")}))},addBook:function(){console.log("add book"),this.form={},this.dialogFormVisible=!0,this.isAdd=!0}}}),we=ye,_e=(a("acd0"),Object(d["a"])(we,ke,xe,!1,null,"3c2d70b0",null)),Ce=_e.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.slice(10*(e.currentPage-1),10*e.currentPage),border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{prop:"id",label:"订单id"}}),a("el-table-column",{attrs:{prop:"userAccount",label:"用户id"}}),a("el-table-column",{attrs:{prop:"bookInfo.name",label:"书籍名称"}}),a("el-table-column",{attrs:{prop:"count",label:"购买数量"}}),a("el-table-column",{attrs:{prop:"bookInfo.price",label:"单价"}}),a("el-table-column",{attrs:{label:"总金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((t.row.bookInfo.price*t.row.count).toFixed(2))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",prop:"created_at",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteOrder(t.row.id)}}},[e._v("删除")])]}}])})],1),a("div",{staticStyle:{float:"right","margin-top":"30px"}},[a("el-pagination",{attrs:{background:"","page-size":10,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.tableData.length},on:{"current-change":e.changePage}})],1)],1)},$e=[],Fe={name:"orders-manage",data:function(){return{tableData:[],currentPage:1,form:{},dialogFormVisible:!1,formLabelWidth:"120px",imgLabelWidth:"120px"}},methods:{changePage:function(e){this.currentPage=e},deleteOrder:function(e){var t=this;console.log("Deleting orderid: "+e),this.axios.post("server/order/delete",{orderid:e}).then((function(e){200===e.status?(t.$options.methods.refresh(t),t.$message({message:"删除成功",showClose:!0,type:"success"})):t.$message.error({message:"删除失败",showClose:!0})})).catch((function(e){console.log(e)}))},refresh:function(e){console.log("refreshing"),console.log(e),e.axios.get("server/order/all").then((function(t){e.tableData=t.data})).catch((function(e){console.log(e)}))}},mounted:function(){var e=this;console.log("ordermanag mounted"),console.log(this),this.axios.get("server/order/all").then((function(t){e.tableData=t.data})).catch((function(e){console.log(e)}))}},Pe=Fe,Oe=Object(d["a"])(Pe,Se,$e,!1,null,null,null),De=Oe.exports,je={name:"manager",data:function(){return{activeTab:"books"}},components:{BookManage:Ce,OrderManage:De}},Ae=je,Ve=(a("15db"),Object(d["a"])(Ae,be,ve,!1,null,"05101288",null)),Be=Ve.exports,Le={books:[{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name11",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name21",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32},{name:"name1",author:"author1",desc:"desc1 desc1 desc1 desc1 desc1 desc1 desc1 desc1 ",price:32}]},Ue={state:Le},Ee=(a("a434"),{bookOrders:[]}),Ne={deleteOrder:function(e,t){e.bookOrders.splice(t,1)},clearCart:function(e){e.bookOrders=[]},addOrder:function(e,t){console.log("add order name: "+t.name),e.bookOrders.push(t)},deleteCommitedOrders:function(e){console.log("deleting commited orders");for(var t=0;t<e.bookOrders.length;t++)1==e.bookOrders[t].commited&&e.bookOrders.splice(t,1)}},qe={totalPrice:function(e){var t=0;return e.bookOrders.forEach((function(e){t+=e.price*e.count})),t},totalOrderCount:function(e){return e.bookOrders.length}},ze={state:Ee,mutations:Ne,getters:qe},Te={login:!1,userAccount:"未登录"},Ie={successLogin:function(e,t){e.userAccount=t,e.login=!0,console.log(t)},quit:function(e){e.userAccount="未登录",e.login=!1}},We={ifLogin:function(e){return e.login},userAccount:function(e){return e.userAccount}},Me={state:Te,mutations:Ie,getters:We};o["default"].use(w["a"]);var Re=new w["a"].Store({state:{},mutations:{},actions:{},modules:{Books:Ue,Orders:ze,Login:Me}});o["default"].use(v["a"]);var Je=[{path:"/store",name:"Store",component:A},{path:"/",redirect:"/store",component:A},{path:"/cart",component:N,meta:{requireAuth:!0}},{path:"/commit-orders",component:M,meta:{requireAuth:!0}},{path:"/user-info",component:Y,meta:{requireAuth:!0}},{path:"/login",component:he},{path:"/manager",component:Be,meta:{requireAuth:!0}}],Ge=new v["a"]({routes:Je});Ge.beforeEach((function(e,t,a){e.meta.requireAuth?Re.getters.ifLogin?a():(alert("请先登录"),a({path:"/login",query:{redirect:e.fullPath}})):a()}));var He=Ge,Qe=(a("0fb7"),a("450d"),a("f529")),Xe=a.n(Qe),Ke=(a("f225"),a("89a9")),Ye=a.n(Ke),Ze=(a("e612"),a("dd87")),et=a.n(Ze),tt=(a("075a"),a("72aa")),at=a.n(tt),ot=(a("eca7"),a("3787")),st=a.n(ot),rt=(a("425f"),a("4105")),nt=a.n(rt),it=(a("10cb"),a("f3ad")),ct=a.n(it),lt=(a("e2f3"),a("06f9")),ut=a.n(lt),dt=(a("a7cc"),a("df33")),mt=a.n(dt),pt=(a("5466"),a("ecdf")),ft=a.n(pt),gt=(a("38a0"),a("ad41")),ht=a.n(gt),bt=(a("f4f9"),a("c2cc")),vt=a.n(bt),kt=(a("7a0f"),a("0f6c")),xt=a.n(kt),yt=(a("adec"),a("3d2d")),wt=a.n(yt),_t=(a("9d4c"),a("e450")),Ct=a.n(_t),St=(a("672e"),a("101e")),$t=a.n(St),Ft=(a("b8e0"),a("a4c4")),Pt=a.n(Ft),Ot=(a("1951"),a("eedf")),Dt=a.n(Ot);o["default"].use(Dt.a),o["default"].use(Pt.a),o["default"].use($t.a),o["default"].use(Ct.a),o["default"].use(wt.a),o["default"].use(xt.a),o["default"].use(vt.a),o["default"].use(ht.a),o["default"].use(ft.a),o["default"].use(mt.a),o["default"].use(ut.a),o["default"].use(ct.a),o["default"].use(nt.a),o["default"].use(st.a),o["default"].use(at.a),o["default"].use(et.a),o["default"].use(Ye.a),Xe.a.install=function(e,t){e.prototype.$message=Xe.a},o["default"].use(Xe.a);var jt=a("bc3a"),At=a.n(jt),Vt=a("4328"),Bt=a.n(Vt),Lt=(a("5f35"),a("2b27")),Ut=a.n(Lt);At.a.defaults.headers.post["Content-Type"]="application/json",At.a.defaults.withCredentials=!0,o["default"].use(Ut.a),o["default"].config.productionTip=!1,o["default"].prototype.axios=At.a,o["default"].prototype.qs=Bt.a,new o["default"]({router:He,store:Re,axios:At.a,render:function(e){return e(b)}}).$mount("#app")},"5f35":function(e,t){e.exports={lintOnSave:!1,devServer:{proxy:{"/server":{target:"http://118.31.58.31:8080",changeOrigin:!0,ws:!0,pathRewrite:{"^/server":""}}}}}},"66c6":function(e,t,a){},"7e83":function(e,t,a){},"80ca":function(e,t,a){},"85ec":function(e,t,a){},"861d2":function(e,t,a){},"879d":function(e,t,a){"use strict";var o=a("8c09"),s=a.n(o);s.a},"8c09":function(e,t,a){},"98ad":function(e,t,a){},a1b0:function(e,t,a){},acd0:function(e,t,a){"use strict";var o=a("80ca"),s=a.n(o);s.a},bb0e:function(e,t,a){"use strict";var o=a("861d2"),s=a.n(o);s.a},d10f:function(e,t,a){"use strict";var o=a("a1b0"),s=a.n(o);s.a},d9fa:function(e,t,a){},ff34:function(e,t,a){"use strict";var o=a("7e83"),s=a.n(o);s.a}});
//# sourceMappingURL=app.967c68e7.js.map